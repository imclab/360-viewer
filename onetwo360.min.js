(function(){var t,e,o,n,i,r,s,u,l,a,d,c,h,f,m,p,v=[].slice;c=void 0,f=void 0,function(){var t,e,n,i,r,u;return e=Math.random(),i="/api/log",t=[],n=!1,r=200,u=400,f=function(){var r,s;if(!n){try{s=JSON.stringify(t)}catch(l){r=l,s="Error stringifying log"}return n=t,t=[],o(i,s,function(o){return setTimeout(function(){return n=!1},u),o?(c("logsync error",o),t=n.concat(t)):(t.push([+new Date,"log sync'ed",e]),d&&t.length>1?f():void 0)})}},c=function(){var e;return e=1<=arguments.length?v.call(arguments,0):[],t.push([+new Date].concat(v.call(e))),t.length>r||d?f():void 0},setTimeout(function(){return s(window,"error",function(){return c("window.onerror","undefined"!=typeof err&&null!==err?err.message:void 0)}),s(window,"beforeunload",function(){var e;c("window.beforeunload");try{o(i,JSON.stringify(t))}catch(n){e=n}return void 0})},0),c("starting",e,window.performance)}(),null==Object.keys&&(Object.keys=function(t){var e,o,n;n=[];for(e in t)o=t[e],n.push(e);return n}),e=XMLHttpRequest,d=!1,"boolean"!=typeof(new e).withCredentials&&(d=!0,e=XDomainRequest),o=function(t,o,n){var i;return i=new e,i.onerror=function(t){return"function"==typeof n?n(t||!0):void 0},i.onload=function(){return"function"==typeof n?n(null,i.responseText):void 0},i.open(o?"POST":"GET",t,!!n),i.send(o),n?void 0:i.responseText},u=function(t,e){var o,n;for(o in e)n=e[o],t[o]=n;return t},i=function(t){var e,o,n,r,s,u;if("object"==typeof t){if(t.constructor===Array)for(n=[],s=0,u=t.length;u>s;s++)e=t[s],n.push(i(e));else{n={};for(o in t)r=t[o],n[o]=i(r)}return n}return t},s=function(t,e,o){return t.addEventListener?t.addEventListener(e,o,!1):t.attachEvent("on"+e,o)},r={frames:{current:0,normal:{width:void 0,height:void 0,urls:[]},zoom:{width:void 0,height:void 0,urls:[]}},spinOnLoadFPS:30,fullscreen:!1,zoom:{lensSize:200,enabled:!1,x:void 0,y:void 0},domElem:{width:void 0,height:void 0,domId:void 0}},t=function(t,e){var o,n,i,r,s,l,a,c,h;for(this.model=t,n=document.getElementById(e),this.defaultWidth=t.width||n.offsetWidth,this.defaultHeight=t.height||n.offsetHeight,this.style={root:{display:"inline-block",cursor:"url(res/cursor_rotate.cur),move"},image:{width:"100%",height:"100%"},zoomLens:{display:"block",position:"absolute",overflow:"hidden",width:this.model.zoom.lensSize,height:this.model.zoom.lensSize,border:"0px solid black",cursor:"default",backgroundColor:d?void 0:"rgba(100,100,100,0.8)",borderRadius:this.model.zoom.lensSize/2,boxShadow:"0px 0px 40px 0px rgba(255,255,255,.7) inset, 4px 4px 9px 0px rgba(0,0,0,0.5)",backgroundRepeat:"no-repeat"},logo:{position:"absolute",opacity:"0.7",textShadow:"0px 0px 5px white",color:"#333",transition:"opacity 1s"},btnFull:{left:"90%"},btnZoom:{left:"5%"},spinner:{position:"absolute",top:"49%",left:"49%"}},o={position:"absolute",color:"#333",opacity:"0.7",textShadow:"0px 0px 5px white",backgroundColor:d?void 0:"rgba(255,255,255,0)",top:"80%",fontSize:.08*this.defaultHeight,padding:.02*this.defaultHeight},u(this.style.btnFull,o),u(this.style.btnZoom,o),this.elems={},this.elems.root=document.createElement("div"),this.elems.root.innerHTML='<img><div class="onetwo360-zoom-lens"></div><i class="icon-OneTwo360Logo"></i><i class="fa fa-fullscreen onetwo360-fullscreen-button"></i><i class="fa fa-search onetwo360-fullscreen-button"></i><img src="spinner.gif">',n.appendChild(this.elems.root),i=Object.keys(this.style),r=a=1,c=i.length-1;c>=1?c>=a:a>=c;r=c>=1?++a:--a)this.elems[i[r]]=this.elems.root.childNodes[r-1];this.width=void 0,this.height=void 0,this.logoFade=void 0,this.imgSrc=void 0,this.elemStyle={},this.styleCache={},h=this.elems;for(s in h)l=h[s],this.elemStyle[s]=this.elems[s].style,this.styleCache[s]={};return this.update(),this},t.prototype.update=function(){var t;if(!this.updateReq)return this.updateReq=!0,t=this,setTimeout(function(){return t._update(),t.updateReq=!1},0)},t.prototype._update=function(){return this._fullscreen(),this._root(),this._logo(),this._zoomLens(),this._image(),this._applyStyle(),c("View#_update'd")},t.prototype._fullscreen=function(){return this.model.fullscreen?u(this.style.root,{position:"absolute",top:0,left:0,width:this.width=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,height:this.height=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight}):u(this.style.root,{position:"relative",top:0,left:0,width:this.width=this.defaultWidth,height:this.height=this.defaultHeight})},t.prototype._root=function(){return void 0},t.prototype._logo=function(){return{top:.35*this.height+"px",left:.25*this.width+"px",fontSize:.2*this.height+"px"}},t.prototype._zoomLens=function(){var t,e;return this.model.zoom.enabled?(t=this.model.frames.current,e=this.model.frames.zoom,u(this.style.zoomLens,{display:"block",left:123,top:123,backgroundImage:"url("+e.urls[t]+")",backgroundSize:""+e.width+"px "+e.height+"px",backgroundPosition:"123px 123px"})):u(this.style.zoomLens,{display:"none"})},t.prototype._image=function(){var t;return t=this.model.frames.normal.urls[this.model.frames.current],void 0!==t&&t!==this.imgSrc?(this.elems.image.src=t,this.imgSrc=t):void 0},t.prototype._applyStyle=function(){var t,e,o,n,i,r;i=this.style,r=[];for(e in i)t=i[e],r.push(function(){var i;i=[];for(o in t)n=t[o],this.styleCache[e][o]!==n?("number"==typeof n&&(n+="px"),this.elemStyle[e][o]=n,i.push(this.styleCache[e][o]=n)):i.push(void 0);return i}.call(this));return r},n=function(t,e){var o,n,i,r,s,u;for(t.loaded=[],o=0,c("caching frameset",t.urls[0]),u=[],n=r=0,s=t.urls.length-1;s>=0?s>=r:r>=s;n=s>=0?++r:--r)i=new Image,i.onload=function(n){return function(){return t.loaded[n]=+new Date,++o===t.urls.length?(c("done caching frameset",t.urls[0]),"function"==typeof e?e():void 0):void 0}}(n),u.push(i.src=t.urls[n]);return u},a=function(t,e,o){var i,r,s,u,l;return l=+new Date,u=void 0,s=0,i=!1,t.frames.current=0,r=function(){var o,n,i,a,d;for(o=0,a=l;t.frames.normal.loaded[o];)a=Math.max(t.frames.normal.loaded[o],a),++o;if(o>t.frames.current+1&&(d=+new Date,null==u&&(u=d),i=(a-l)/o,n=Math.max(i,1e3/t.spinOnLoadFPS),d>u+n)){for(;d>u+n;)s=t.frames.current=Math.min(o-1,t.frames.current+1),u+=n;u=d,c("incremental load animation",s),e.update()}return t.frames.current===s&&t.frames.current<t.frames.normal.urls.length-1?setTimeout(r,0):c("finished incremental load animation")},t.spinOnLoadFPS?(n(t.frames.normal),c("starting incremental load animation"),r()):n(t.frames.normal(o))},m=+new Date,l=function(t,e){return s(document,"mousemove",function(o){return c("mousemove",o.clientX,o.clientY),t.frames.current=(o.clientX/20|0)%t.frames.normal.urls.length,e.update()}),s(document,"touchmove",function(t){return c("touchmove",t.touches)})},p=void 0,h=void 0,function(){var t,e,o,n,i,r,u,l,a;return l=void 0,h=function(t){return l=t},u=500,r=100,a=function(t,e){var o,n;return o=e.clientX,n=e.clientY,t.event=e,t.ddx=o-t.x||0,t.ddy=n-t.y||0,t.dx=o-t.x0,t.dy=n-t.y0,t.maxDist2=t.dx*t.dx+t.dy*t.dy,t.time=Date.now()-t.startTime,t.x=o,t.y=n},n=function(t,e,o){var n;return l=o,l.handler=e,l.x0=t.clientX,l.y0=t.clientY,l.x=t.clientX,l.y=t.clientY,c("startTouch",l.x,l.y),l.startTime=Date.now(),a(l,t),l.ctx=e.start(l),n=function(){return l&&!l.holding&&l.maxDist2<r?(l.holding=!0,l.handler.hold(l)):void 0},setTimeout(n,u)},o=function(t){return a(l,t),c("moveTouch",l.x,l.y),l.ctx=l.handler.move(l||l.ctx)},i=function(){return c("stopTouch"),l.handler.end(l),l.maxDist2<r&&l.time<u&&l.handler.click(l),l=void 0},t=function(t){return function(e){var o;return l?("function"==typeof e.preventDefault&&e.preventDefault(),t((null!=(o=e.touches)?o[0]:void 0)||e)):void 0}},e=runOnce(function(){return s(document,"mousemove",t(o)),s(document,"touchmove",t(o)),s(document,"mouseup",function(e){return c("mouseup"),t(i)(e)}),s(document,"touchend",t(i))}),p=function(t){return s(t.elem,"mousedown",function(e){return"function"==typeof e.preventDefault&&e.preventDefault(),n(e,t,{isMouse:!0})}),s(t.elem,"touchstart",function(e){return"function"==typeof e.preventDefault&&e.preventDefault(),n(e.touches[0],t,{})}),e(),t.start||(t.start=nop),t.move||(t.move=nop),t.end||(t.end=nop),t.drag||(t.drag=nop),t.click||(t.click=nop),t.hold||(t.hold=nop),t}}(),window.onetwo360=function(){return void 0}}).call(this);